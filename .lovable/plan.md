

# План: Исправление отображения элементов Calm Urgency

## Проблема
Компонент `CalmUrgency` не отображается на странице товара, потому что:

1. **Логика `showAfterScroll`** — компонент возвращает `null` до тех пор, пока `window.scrollY > 150`
2. **Sticky-hero на мобильном** — особая логика прокрутки с трансформациями может мешать корректному определению scroll position
3. **Начальная загрузка** — при первом рендере `isVisible = false`, компонент не показывается

---

## Решение

Изменить компонент так, чтобы он **всегда отображался**, но **анимировался при прокрутке** (вместо полного скрытия):

### Вариант A (рекомендуется): Убрать scroll-триггер полностью
Показывать элементы сразу — они и так расположены ниже CTA кнопки, пользователь их увидит в нужный момент.

### Вариант B: Использовать `useInView` вместо scroll position
Использовать `framer-motion` IntersectionObserver для определения видимости, что работает надёжнее с нестандартной прокруткой.

---

## Изменения

**src/components/product/CalmUrgency.tsx:**

```text
До:
- Слушает window.scrollY
- Возвращает null если scrollY < 150

После:
- Показывается сразу (без scroll-триггера)
- Или использует useInView для плавного появления
- Анимация при появлении в viewport (уже есть)
```

### Конкретные изменения кода:

1. **Убрать условие `if (!isVisible) return null`** (строка 72)
2. **Убрать useEffect для scroll** (строки 31-40)
3. **Оставить только анимацию входа с motion.div**

---

## Альтернативный вариант: useInView

```typescript
import { useRef } from 'react';
import { useInView } from 'framer-motion';

const ref = useRef(null);
const isInView = useInView(ref, { once: true, margin: "-50px" });

return (
  <motion.div
    ref={ref}
    initial={{ opacity: 0, y: 10 }}
    animate={isInView ? { opacity: 1, y: 0 } : { opacity: 0, y: 10 }}
    // ...
  >
```

Это обеспечит плавное появление когда элемент попадает в viewport, без зависимости от `window.scrollY`.

---

## Итог

Простое решение: убрать логику `showAfterScroll` и показывать элементы urgency сразу под кнопкой "Size Chart". Они и так расположены в правильном месте на странице, и пользователь увидит их при естественной прокрутке.

